<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
if (location.protocol === 'http:') {
  location.href = location.href.replace('http:', 'https:');
}
</script>

<title>CorporaciÃ³n La Fuerte</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Montserrat',sans-serif;
  background:linear-gradient(135deg,#1a1a2e,#16213e);
  color:#fff;
}

/* HEADER */
header{
  background:#0f3460;
  text-align:center;
  padding:2rem 1rem 1.5rem;
}

header h1{
  color:#ffeb3b;
  margin:0;
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
  padding:14px;
}

/* CARD */
.card{
  background:#222831;
  border:2px solid #ff6f61;
  border-radius:16px;
  padding:12px;
  text-align:center;
  position:relative;
  cursor:pointer;
}

.card.activa{
  border-color:#ffcc00;
  box-shadow:0 0 18px rgba(255,204,0,.9);
}

.card.activa::before{
  content:"ðŸ”´ EN VIVO";
  position:absolute;
  top:6px;
  right:6px;
  background:red;
  padding:3px 8px;
  border-radius:12px;
  font-size:.7rem;
}

.logo{
  width:90px;
  height:90px;
  background:#fff;
  padding:5px;
  border-radius:10px;
}

h2{
  color:#ffcc00;
  font-size:15px;
  margin:8px 0;
}

.song{
  font-size:12px;
  color:#ddd;
  margin-top:6px;
  min-height:16px;
}

/* PLAY */
.play-btn{
  width:54px;
  height:54px;
  border-radius:50%;
  border:none;
  background:#ffcc00;
  cursor:pointer;
  position:relative;
}

.play-btn::before{
  content:"â–¶";
  font-size:22px;
  color:#000;
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-45%,-50%);
}

.play-btn.stop{
  background:#ff3b3b;
}

.play-btn.stop::before{
  content:"â– ";
  transform:translate(-50%,-50%);
}

/* FOOTER */
footer{
  text-align:center;
  padding:1rem;
  background:#0f0f0f;
  color:#aaa;
  font-size:.85rem;
}
</style>
</head>

<body>

<header>
  <h1>CorporaciÃ³n La Fuerte</h1>
</header>

<main class="grid">

<!-- LA FUERTE -->
<div class="card" data-stream="https://panelautodj.innovatestream.pe/7322/" data-port="7322">
  <img src="https://imgfz.com/i/fmdxHD8.png" class="logo">
  <h2>La Fuerte</h2>
  <button class="play-btn"></button>
  <div class="song">ðŸŽµ En vivoâ€¦</div>
</div>

<!-- LA JEFA -->
<div class="card" data-stream="https://panelautodj.innovatestream.pe/7320/" data-port="7320">
  <img src="https://imgfz.com/i/FRicwT8.png" class="logo">
  <h2>La Jefa</h2>
  <button class="play-btn"></button>
  <div class="song">ðŸŽµ En vivoâ€¦</div>
</div>

<!-- SAN FRANCISCO -->
<div class="card" data-stream="https://panelautodj.innovatestream.pe/7324/" data-port="7324">
  <img src="https://imgfz.com/i/bBApQu2.png" class="logo">
  <h2>San Francisco</h2>
  <button class="play-btn"></button>
  <div class="song">ðŸŽµ En vivoâ€¦</div>
</div>

<!-- MÃXIMA -->
<div class="card" data-stream="https://panelautodj.innovatestream.pe/8342/" data-port="8342">
  <img src="https://imgfz.com/i/bVMWlXD.png" class="logo">
  <h2>MÃ¡xima</h2>
  <button class="play-btn"></button>
  <div class="song">ðŸŽµ En vivoâ€¦</div>
</div>

<!-- LA CUMBIAMBERA -->
<div class="card" data-stream="https://panelautodj.innovatestream.pe/8464/" data-port="8464">
  <img src="https://imgfz.com/i/J89AMPT.png" class="logo">
  <h2>La Cumbiambera</h2>
  <button class="play-btn"></button>
  <div class="song">ðŸŽµ En vivoâ€¦</div>
</div>

<!-- LA RAYA -->
<div class="card" data-stream="https://panelautodj.innovatestream.pe/8466/" data-port="8466">
  <img src="https://imgfz.com/i/zauB0Id.png" class="logo">
  <h2>La Raya</h2>
  <button class="play-btn"></button>
  <div class="song">ðŸŽµ En vivoâ€¦</div>
</div>

</main>

<footer>Â© 2025 CorporaciÃ³n La Fuerte</footer>

<script>
let currentAudio = null;
let songInterval = null;

function fetchSong(card){
  const port = card.dataset.port;
  const songDiv = card.querySelector('.song');

  fetch(`https://panelautodj.innovatestream.pe:${port}/status-json.xsl`)
    .then(r=>r.json())
    .then(data=>{
      const source = data.icestats.source;
      const title = Array.isArray(source) ? source[0].title : source.title;
      songDiv.textContent = title ? 'ðŸŽµ ' + title : 'ðŸŽµ En vivoâ€¦';
    })
    .catch(()=>{
      songDiv.textContent = 'ðŸŽµ En vivoâ€¦';
    });
}

function playRadio(card){
  const btn = card.querySelector('.play-btn');
  const stream = card.dataset.stream;

  // STOP
  if(card.classList.contains('activa')){
    if(currentAudio){
      currentAudio.src='';
      currentAudio=null;
    }
    clearInterval(songInterval);
    card.classList.remove('activa');
    btn.classList.remove('stop');
    return;
  }

  // Detener otra
  if(currentAudio){
    currentAudio.src='';
    currentAudio=null;
  }
  clearInterval(songInterval);

  document.querySelectorAll('.card').forEach(c=>c.classList.remove('activa'));
  document.querySelectorAll('.play-btn').forEach(b=>b.classList.remove('stop'));

  currentAudio = new Audio(stream + '?t=' + Date.now());
  currentAudio.play();

  card.classList.add('activa');
  btn.classList.add('stop');

  fetchSong(card);
  songInterval = setInterval(()=>fetchSong(card),10000);
}

document.querySelectorAll('.play-btn').forEach(btn=>{
  btn.addEventListener('click', e=>{
    e.stopPropagation();
    playRadio(btn.closest('.card'));
  });
});

document.querySelectorAll('.card').forEach(card=>{
  card.addEventListener('click', ()=>{
    playRadio(card);
  });
});
</script>

</body>
</html>
